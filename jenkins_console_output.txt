Started by user Sivasankari S S
Obtained Jenkinsfile from git https://github.com/Sivasankari-0609/Capstone-project.git
[Pipeline] Start of Pipeline
[Pipeline] node
Running on Jenkins in /var/lib/jenkins/workspace/capstone-jn-pipeline
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Declarative: Checkout SCM)
[Pipeline] checkout
Selected Git installation does not exist. Using Default
The recommended git tool is: NONE
No credentials specified
 > git rev-parse --resolve-git-dir /var/lib/jenkins/workspace/capstone-jn-pipeline/.git # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url https://github.com/Sivasankari-0609/Capstone-project.git # timeout=10
Fetching upstream changes from https://github.com/Sivasankari-0609/Capstone-project.git
 > git --version # timeout=10
 > git --version # 'git version 2.43.0'
 > git fetch --tags --force --progress -- https://github.com/Sivasankari-0609/Capstone-project.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git rev-parse refs/remotes/origin/main^{commit} # timeout=10
Checking out Revision 1baa096908c01afee522f9719af1f63a902623e3 (refs/remotes/origin/main)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 1baa096908c01afee522f9719af1f63a902623e3 # timeout=10
Commit message: "changes done"
 > git rev-list --no-walk 872e152fecb1d4c350348705f6cbe4b8b52a83d7 # timeout=10
[Pipeline] }
[Pipeline] // stage
[Pipeline] withEnv
[Pipeline] {
[Pipeline] withEnv
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Declarative: Tool Install)
[Pipeline] tool
[Pipeline] envVarsForTool
[Pipeline] }
[Pipeline] // stage
[Pipeline] withEnv
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Checkout)
[Pipeline] tool
[Pipeline] envVarsForTool
[Pipeline] withEnv
[Pipeline] {
[Pipeline] git
Selected Git installation does not exist. Using Default
The recommended git tool is: NONE
No credentials specified
 > git rev-parse --resolve-git-dir /var/lib/jenkins/workspace/capstone-jn-pipeline/.git # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url https://github.com/Sivasankari-0609/Capstone-project.git # timeout=10
Fetching upstream changes from https://github.com/Sivasankari-0609/Capstone-project.git
 > git --version # timeout=10
 > git --version # 'git version 2.43.0'
 > git fetch --tags --force --progress -- https://github.com/Sivasankari-0609/Capstone-project.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git rev-parse refs/remotes/origin/main^{commit} # timeout=10
Checking out Revision 1baa096908c01afee522f9719af1f63a902623e3 (refs/remotes/origin/main)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 1baa096908c01afee522f9719af1f63a902623e3 # timeout=10
 > git branch -a -v --no-abbrev # timeout=10
 > git branch -D main # timeout=10
 > git checkout -b main 1baa096908c01afee522f9719af1f63a902623e3 # timeout=10
Commit message: "changes done"
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Build & Test)
[Pipeline] tool
[Pipeline] envVarsForTool
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ npm ci

added 65 packages, and audited 66 packages in 700ms

19 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities
[Pipeline] sh
+ npm test

> capstone_nodefile@1.0.0 test
> echo "Skipping tests"

Skipping tests
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Build Docker Image)
[Pipeline] tool
[Pipeline] envVarsForTool
[Pipeline] withEnv
[Pipeline] {
[Pipeline] script
[Pipeline] {
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker build -t sivasankariss/capstone-app:21 .
#0 building with "default" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 174B done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/node:18-alpine
#2 DONE 1.4s

#3 [internal] load .dockerignore
#3 transferring context: 2B done
#3 DONE 0.0s

#4 [1/5] FROM docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e
#4 resolve docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e 0.0s done
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 3.15MB 0.1s done
#5 DONE 0.1s

#6 [2/5] WORKDIR /app
#6 CACHED

#7 [3/5] COPY package*.json ./
#7 CACHED

#8 [4/5] RUN npm ci --omit=dev
#8 CACHED

#9 [5/5] COPY . .
#9 DONE 0.4s

#10 exporting to image
#10 exporting layers
#10 exporting layers 0.2s done
#10 exporting manifest sha256:a63071965b207a74bf8b4a38707396e9ced725258573f74804ccd9d6c78fe5fe 0.0s done
#10 exporting config sha256:c74f3df918ffed9aeb8ef9388760d8694811bec683fbae156c6c595ce72b58f0 0.0s done
#10 exporting attestation manifest sha256:7342eef6a38f46c1187f70b0236fd918e35b080c8c2af35e360a39d908b73671 0.0s done
#10 exporting manifest list sha256:78dfdad478338e517b1568e246eb72971703bb05dba6a2fff0f1812a2e234223 0.0s done
#10 naming to docker.io/sivasankariss/capstone-app:21
#10 naming to docker.io/sivasankariss/capstone-app:21 done
#10 unpacking to docker.io/sivasankariss/capstone-app:21 0.1s done
#10 DONE 0.4s
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // script
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Push to Docker Hub)
[Pipeline] tool
[Pipeline] envVarsForTool
[Pipeline] withEnv
[Pipeline] {
[Pipeline] script
[Pipeline] {
[Pipeline] withEnv
[Pipeline] {
[Pipeline] withDockerRegistry
$ docker login -u sivasankariss -p ******** https://index.docker.io/v1/
WARNING! Using --password via the CLI is insecure. Use --password-stdin.

WARNING! Your credentials are stored unencrypted in '/var/lib/jenkins/workspace/capstone-jn-pipeline@tmp/993a22bc-df99-493d-8d07-dfd88739f776/config.json'.
Configure a credential helper to remove this warning. See
https://docs.docker.com/go/credential-store/

Login Succeeded
[Pipeline] {
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker tag sivasankariss/capstone-app:21 index.docker.io/sivasankariss/capstone-app:21
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker push index.docker.io/sivasankariss/capstone-app:21
The push refers to repository [docker.io/sivasankariss/capstone-app]
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
326446afa540: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
326446afa540: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
3af39ce516ab: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
3af39ce516ab: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
e1b5e8af62ce: Layer already exists
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
1e5a4c89cee5: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
25ff2da83641: Waiting
266d5986e923: Waiting
dd71dde834b5: Waiting
326446afa540: Waiting
3af39ce516ab: Waiting
f18232174bc9: Waiting
b5ab2c7a6942: Waiting
1e5a4c89cee5: Waiting
3af39ce516ab: Waiting
f18232174bc9: Layer already exists
b5ab2c7a6942: Waiting
1e5a4c89cee5: Layer already exists
25ff2da83641: Layer already exists
266d5986e923: Layer already exists
dd71dde834b5: Layer already exists
326446afa540: Layer already exists
3af39ce516ab: Waiting
3af39ce516ab: Waiting
3af39ce516ab: Pushed
b5ab2c7a6942: Pushed
21: digest: sha256:78dfdad478338e517b1568e246eb72971703bb05dba6a2fff0f1812a2e234223 size: 856
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // withDockerRegistry
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // script
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Deploy to app-ec2)
[Pipeline] tool
[Pipeline] envVarsForTool
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sshagent
[ssh-agent] Using credentials ubuntu (Docker EC2 deploy key)
$ ssh-agent
SSH_AUTH_SOCK=/tmp/ssh-31CMCE5Un0y5/agent.6023
SSH_AGENT_PID=6026
Running ssh-add (command line suppressed)
Identity added: /var/lib/jenkins/workspace/capstone-jn-pipeline@tmp/private_key_14723147909643347005.key (/var/lib/jenkins/workspace/capstone-jn-pipeline@tmp/private_key_14723147909643347005.key)
[ssh-agent] Started.
[Pipeline] {
[Pipeline] sh
+ ssh -o StrictHostKeyChecking=no ubuntu@52.66.132.202 
                            docker stop app || true
                            docker rm app || true
                            docker pull sivasankariss/capstone-app:21
                            docker run -d --name app -p 3000:3000 sivasankariss/capstone-app:21
                        
app
app
21: Pulling from sivasankariss/capstone-app
f18232174bc9: Already exists
dd71dde834b5: Already exists
1e5a4c89cee5: Already exists
25ff2da83641: Already exists
266d5986e923: Already exists
e1b5e8af62ce: Already exists
326446afa540: Already exists
b5ab2c7a6942: Pulling fs layer
b5ab2c7a6942: Verifying Checksum
b5ab2c7a6942: Download complete
b5ab2c7a6942: Pull complete
Digest: sha256:78dfdad478338e517b1568e246eb72971703bb05dba6a2fff0f1812a2e234223
Status: Downloaded newer image for sivasankariss/capstone-app:21
docker.io/sivasankariss/capstone-app:21
9e2e1d9d954727ac44f0a8e9cbe4d6395cd4c6ab817aa082b00ccb65ab023663
[Pipeline] }
$ ssh-agent -k
unset SSH_AUTH_SOCK;
unset SSH_AGENT_PID;
echo Agent pid 6026 killed;
[ssh-agent] Stopped.
[Pipeline] // sshagent
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Declarative: Post Actions)
[Pipeline] sh
+ docker system prune -f
Deleted build cache objects:
y6rnzusc3zuqer9320zulayje
hxw26kbmiqeic6pdc9rw9qvg2
r3gkfeo6z8vlmwf3122r8p2ff

Total reclaimed space: 5.779MB
[Pipeline] }
[Pipeline] // stage
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // node
[Pipeline] End of Pipeline
Finished: SUCCESS
